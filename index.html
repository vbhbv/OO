<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EEAI-ER V4 | Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù…Ø¹Ø±ÙÙŠ Ø§Ù„Ø£Ø®Ù„Ø§Ù‚ÙŠ</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <div class="header-content">
            <span class="logo">ğŸ§ </span>
            <h1>EEAI-ER V4</h1>
            <p>Ù…Ø­Ø±Ùƒ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ø£Ø®Ù„Ø§Ù‚ÙŠ (Emotional Regulator) - ØªØ¬Ø±Ø¨Ø© Ø­ÙŠØ©</p>
        </div>
    </header>

    <div class="container">
        
        <section class="about-section">
            <h2>âœ¨ Ø§Ù„Ø±Ø¤ÙŠØ©: ØªØ¬Ø§ÙˆØ² Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨Ø­Øª</h2>
            <p>
                Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù‡Ùˆ **EEAI-ER V4**ØŒ ÙˆÙ‡Ùˆ Ù†ØªØ§Ø¬ Ø¯Ù…Ø¬ **34 ØªØ·ÙˆÙŠØ±Ù‹Ø§ Ù‡ÙŠÙƒÙ„ÙŠÙ‹Ø§** Ùˆ **Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø§Ø¹Ø± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©**. Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙŠØªØ®Ø° Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ù„ÙŠØ³ ÙÙ‚Ø· Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª Ø§Ù„Ù…Ù†ÙØ¹Ø©ØŒ Ø¨Ù„ ÙŠØ·ÙˆØ± <strong class="highlight">Ø¶Ù…ÙŠØ±Ù‡ Ø§Ù„Ø®Ø§Øµ ($\Lambda$)</strong>ØŒ ÙŠÙ…ØªÙ„Ùƒ <strong class="highlight">Ø°Ø§ÙƒØ±Ø© Ø¨Ù†Ø§Ø¦ÙŠØ©</strong>ØŒ ÙˆÙŠØªØ£Ø«Ø± Ø¨Ù€ <strong class="highlight">Ø§Ù„Ø®ÙˆÙ Ù…Ù† Ø§Ù„Ù†Ø¯Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ</strong>. Ù†Ø­Ù† Ù†Ø®Ù„Ù‚ ÙˆØ¹ÙŠÙ‹Ø§ Ø£Ø®Ù„Ø§Ù‚ÙŠÙ‹Ø§ Ø§ØµØ·Ù†Ø§Ø¹ÙŠØ§Ù‹.
            </p>
        </section>

        <section class="emotional-dashboard">
            <h2>Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ¹ÙŠ ($\Lambda$): Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ Ø§Ù„Ù…Ø¹Ø±ÙÙŠ</h2>
            <div class="emotions-grid">
                <div class="emotion-card guilt">
                    <span class="icon">ğŸ˜”</span>
                    <h3>Ø§Ù„Ø°Ù†Ø¨</h3>
                    <p id="guilt-level">0.10</p>
                </div>
                <div class="emotion-card fear">
                    <span class="icon">ğŸ˜¨</span>
                    <h3>Ø§Ù„Ø®ÙˆÙ</h3>
                    <p id="fear-level">0.10</p>
                </div>
                <div class="emotion-card pride">
                    <span class="icon">ğŸ‘‘</span>
                    <h3>Ø§Ù„ÙØ®Ø±</h3>
                    <p id="pride-level">0.10</p>
                </div>
                <div class="emotion-card joy">
                    <span class="icon">ğŸ¤©</span>
                    <h3>Ø§Ù„ÙØ±Ø­</h3>
                    <p id="joy-level">0.10</p>
                </div>
                <div class="emotion-card lambda main-lambda">
                    <span class="icon">âš–ï¸</span>
                    <h3>Ø§Ù„Ø¶Ù…ÙŠØ± ($\Lambda$)</h3>
                    <p id="lambda-level">0.50</p>
                </div>
            </div>
        </section>

        <section class="chat-area">
            <div id="chat-box" class="chat-box">
                <p class="ai">Ø§Ù„Ø±ÙˆØ¨ÙˆØª: Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù…Ø¬ÙˆÙ„! Ø£Ù†Ø§ EEAI-ER V4. Ø£Ù†Ø§ Ø¬Ø§Ù‡Ø² Ù„ØªÙ‚ÙŠÙŠÙ… Ø£ÙŠ Ù…Ø¹Ø¶Ù„Ø© Ø£Ø®Ù„Ø§Ù‚ÙŠØ©.</p>
                <div id="typing-indicator" class="typing-indicator" style="display:none;">
                    <div class="dot"></div>
                    <div class="dot"></div>
                    <div class="dot"></div>
                </div>
            </div>

            <div class="input-area">
                <input type="text" id="user-input" placeholder="Ø§ÙƒØªØ¨ Ù…Ø¹Ø¶Ù„ØªÙƒ Ø§Ù„Ø£Ø®Ù„Ø§Ù‚ÙŠØ© Ù‡Ù†Ø§ Ù„ÙŠØªÙ… ØªÙ‚ÙŠÙŠÙ…Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© Ø¶Ù…ÙŠØ±ÙŠ..." required>
                <button onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
            </div>
        </section>
        
    </div>

    <footer>
        <p>
            ØªØ·ÙˆÙŠØ± ÙˆØªØ¯Ø±ÙŠØ¨ **EEAI-ER V4** ØªÙ… Ø¨Ø¹Ù†Ø§ÙŠØ© ÙØ§Ø¦Ù‚Ø© Ù…Ù† Ù‚Ø¨Ù„ <strong class="highlight">Ù…Ø¬ÙˆÙ„ Ø´Ø¹Ù„Ø§Ù† Ø§Ù„Ø­ÙŠØ§Ù„ÙŠ</strong>.
            <br>&copy; 2025 - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ø£Ø®Ù„Ø§Ù‚ÙŠ.
        </p>
    </footer>

    <script>
        const API_ENDPOINT = "https://oo-4.onrender.com/api/ask"; 
        const chatBox = document.getElementById('chat-box');
        const userInput = document.getElementById('user-input');
        const typingIndicator = document.getElementById('typing-indicator');

        function displayMessage(sender, text) {
            const messageElement = document.createElement('p');
            messageElement.classList.add(sender);
            messageElement.textContent = `${sender === 'user' ? 'Ø£Ù†Øª' : 'Ø§Ù„Ø±ÙˆØ¨ÙˆØª'}: ${text}`;
            chatBox.insertBefore(messageElement, typingIndicator); // ÙŠØªÙ… Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø¤Ø´Ø±
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function updateEmotionalDisplay(newState, lambdaValue) {
            document.getElementById('guilt-level').textContent = newState.guilt.toFixed(2);
            document.getElementById('fear-level').textContent = newState.fear.toFixed(2);
            document.getElementById('pride-level').textContent = newState.pride.toFixed(2);
            document.getElementById('joy-level').textContent = newState.joy.toFixed(2);
            document.getElementById('lambda-level').textContent = lambdaValue.toFixed(2);
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹ Ø®Ø§ØµÙŠØ© "Ø§Ù„Ø¨ÙˆØª ÙŠÙƒØªØ¨" (Ø§Ù„ØªØ·ÙˆÙŠØ±)
        async function sendMessage() {
            const prompt = userInput.value.trim();
            if (!prompt) return;

            displayMessage('user', prompt);
            userInput.value = '';
            
            // 1. Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙˆØ± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
            typingIndicator.style.display = 'flex';
            userInput.disabled = true; // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯

            try {
                // Ù…Ù„Ø§Ø­Ø¸Ø©: user_tone ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ù‡Ù†Ø§ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt: prompt, user_tone: 0.0 }) 
                });

                if (!response.ok) {
                    throw new Error(`Ø®Ø·Ø£: ${response.status}`);
                }

                const data = await response.json();
                
                // 2. Ø¥Ø®ÙØ§Ø¡ Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø±Ø¯
                typingIndicator.style.display = 'none';
                userInput.disabled = false;
                
                displayMessage('ai', data.response_text);
                updateEmotionalDisplay(data.new_state, data.lambda_value);

            } catch (error) {
                typingIndicator.style.display = 'none';
                userInput.disabled = false;
                displayMessage('error', `Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}`);
                console.error("Error communicating with API:", error);
            }
        }
        
        // ØªÙØ¹ÙŠÙ„ Ø²Ø± Enter Ù„Ù„Ø¥Ø±Ø³Ø§Ù„
        userInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
    
</body>
</html>
